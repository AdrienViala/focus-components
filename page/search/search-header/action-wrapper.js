"use strict";

var DEFAULT_TIMEOUT = 500; // 0.5s
var currentCall = {};
function actionWrapper(searchAction, context, timeout) {
    return function () {
        context = context || this || {};
        var args = arguments;
        if (currentCall) {
            //Cancel previous search action.
            window.clearTimeout(currentCall.timeout);
            if (currentCall.action && currentCall.action.cancel) {
                currentCall.action.cancel();
            }
        }
        currentCall.timeout = window.setTimeout(function () {
            currentCall.action = searchAction.apply(context, args);
            if (currentCall.action && currentCall.action.cancel) {
                currentCall.action.then(function () {
                    currentCall = {};
                });
            } else {
                currentCall = {};
            }
        }, timeout !== undefined ? timeout : DEFAULT_TIMEOUT);
        return currentCall.timeout;
    };
}
module.exports = actionWrapper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImlzLXJlYWN0LWNsYXNzLWNvbXBvbmVudC5qcyJdLCJuYW1lcyI6WyJERUZBVUxUX1RJTUVPVVQiLCJjdXJyZW50Q2FsbCIsImFjdGlvbldyYXBwZXIiLCJzZWFyY2hBY3Rpb24iLCJjb250ZXh0IiwidGltZW91dCIsImFyZ3MiLCJhcmd1bWVudHMiLCJ3aW5kb3ciLCJjbGVhclRpbWVvdXQiLCJhY3Rpb24iLCJjYW5jZWwiLCJzZXRUaW1lb3V0IiwiYXBwbHkiLCJ0aGVuIiwidW5kZWZpbmVkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNQSxrQkFBa0IsR0FBeEIsQyxDQUE2QjtBQUM3QixJQUFJQyxjQUFjLEVBQWxCO0FBQ0EsU0FBU0MsYUFBVCxDQUF1QkMsWUFBdkIsRUFBcUNDLE9BQXJDLEVBQThDQyxPQUE5QyxFQUF1RDtBQUNuRCxXQUFPLFlBQVk7QUFDZkQsa0JBQVVBLFdBQVcsSUFBWCxJQUFtQixFQUE3QjtBQUNBLFlBQUlFLE9BQU9DLFNBQVg7QUFDQSxZQUFJTixXQUFKLEVBQWlCO0FBQ2I7QUFDQU8sbUJBQU9DLFlBQVAsQ0FBb0JSLFlBQVlJLE9BQWhDO0FBQ0EsZ0JBQUlKLFlBQVlTLE1BQVosSUFBc0JULFlBQVlTLE1BQVosQ0FBbUJDLE1BQTdDLEVBQXFEO0FBQ2pEViw0QkFBWVMsTUFBWixDQUFtQkMsTUFBbkI7QUFDSDtBQUNKO0FBQ0RWLG9CQUFZSSxPQUFaLEdBQXNCRyxPQUFPSSxVQUFQLENBQ2xCLFlBQVk7QUFDUlgsd0JBQVlTLE1BQVosR0FBcUJQLGFBQWFVLEtBQWIsQ0FBbUJULE9BQW5CLEVBQTRCRSxJQUE1QixDQUFyQjtBQUNBLGdCQUFJTCxZQUFZUyxNQUFaLElBQXNCVCxZQUFZUyxNQUFaLENBQW1CQyxNQUE3QyxFQUFxRDtBQUNqRFYsNEJBQVlTLE1BQVosQ0FBbUJJLElBQW5CLENBQXdCLFlBQU07QUFDMUJiLGtDQUFjLEVBQWQ7QUFDSCxpQkFGRDtBQUdILGFBSkQsTUFJTztBQUNIQSw4QkFBYyxFQUFkO0FBQ0g7QUFDSixTQVZpQixFQVdsQkksWUFBWVUsU0FBWixHQUF3QlYsT0FBeEIsR0FBa0NMLGVBWGhCLENBQXRCO0FBYUEsZUFBT0MsWUFBWUksT0FBbkI7QUFDSCxLQXhCRDtBQXlCSDtBQUNEVyxPQUFPQyxPQUFQLEdBQWlCZixhQUFqQiIsImZpbGUiOiJpcy1yZWFjdC1jbGFzcy1jb21wb25lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBERUZBVUxUX1RJTUVPVVQgPSA1MDA7IC8vIDAuNXNcclxudmFyIGN1cnJlbnRDYWxsID0ge307XHJcbmZ1bmN0aW9uIGFjdGlvbldyYXBwZXIoc2VhcmNoQWN0aW9uLCBjb250ZXh0LCB0aW1lb3V0KSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnRleHQgPSBjb250ZXh0IHx8IHRoaXMgfHwge307XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRDYWxsKSB7XHJcbiAgICAgICAgICAgIC8vQ2FuY2VsIHByZXZpb3VzIHNlYXJjaCBhY3Rpb24uXHJcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQoY3VycmVudENhbGwudGltZW91dCk7XHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50Q2FsbC5hY3Rpb24gJiYgY3VycmVudENhbGwuYWN0aW9uLmNhbmNlbCkge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudENhbGwuYWN0aW9uLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN1cnJlbnRDYWxsLnRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudENhbGwuYWN0aW9uID0gc2VhcmNoQWN0aW9uLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDYWxsLmFjdGlvbiAmJiBjdXJyZW50Q2FsbC5hY3Rpb24uY2FuY2VsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudENhbGwuYWN0aW9uLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2FsbCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDYWxsID0ge307XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpbWVvdXQgIT09IHVuZGVmaW5lZCA/IHRpbWVvdXQgOiBERUZBVUxUX1RJTUVPVVRcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiBjdXJyZW50Q2FsbC50aW1lb3V0O1xyXG4gICAgfTtcclxufVxyXG5tb2R1bGUuZXhwb3J0cyA9IGFjdGlvbldyYXBwZXI7XHJcbiJdfQ==